{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Restaurant Admin Dashboard</title>

    <!-- plugins:css -->
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/mdi/css/materialdesignicons.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/css/vendor.bundle.base.css' %}">
    <!-- endinject -->

    <!-- Plugin css for this page -->
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/jvectormap/jquery-jvectormap.css' %}">
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/flag-icon-css/css/flag-icon.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/owl-carousel-2/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/owl-carousel-2/owl.theme.default.min.css' %}">
    <!-- End plugin css for this page -->

    <!-- Layout styles -->
    <link rel="stylesheet" href="{% static 'admin/assets/css/style.css' %}">
    <link rel="stylesheet" href="{% static 'admin/assets/css/custom-overrides.css' %}">
    <link rel="shortcut icon" href="{% static 'admin/assets/images/favicon.png' %}" />
  </head>
  <body>
    <div class="container-scroller">

      <!-- Sidebar -->
      <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <div class="sidebar-brand-wrapper d-none d-lg-flex align-items-center justify-content-center fixed-top">
          <a class="sidebar-brand brand-logo" href="#"><img src="{% static 'admin/assets/images/logo.svg' %}" alt="logo" /></a>
          <a class="sidebar-brand brand-logo-mini" href="#"><img src="{% static 'admin/assets/images/logo-mini.svg' %}" alt="logo" /></a>
        </div>

        <ul class="nav">
          <li class="nav-item profile">
            <div class="profile-desc">
              <div class="profile-pic">
                <div class="count-indicator">
                  <img class="img-xs rounded-circle" src="{% static 'admin/assets/images/faces/face15.jpg' %}" alt="">
                  <span class="count bg-success"></span>
                </div>
                <div class="profile-name">
                  <h5 class="mb-0 font-weight-normal">Admin</h5>
                  <span>Restaurant Manager</span>
                </div>
              </div>
            </div>
          </li>

          <li class="nav-item nav-category"><span class="nav-link">Navigation</span></li>

          <li class="nav-item menu-items">
            <a class="nav-link" href="#"><span class="menu-icon"><i class="mdi mdi-speedometer"></i></span><span class="menu-title">Dashboard</span></a>
          </li>

          <!-- Dropdown: Food Items -->
          <li class="nav-item menu-items">
            <a class="nav-link" data-toggle="collapse" href="#food-menu" aria-expanded="false" aria-controls="food-menu">
              <span class="menu-icon"><i class="mdi mdi-silverware"></i></span>
              <span class="menu-title">Food Items</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="food-menu">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"><a class="nav-link" href="{% url 'admin_app:add_category' %}">Add Category</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'admin_app:view_category' %}">View Category</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'admin_app:add_food' %}">Add Food</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'admin_app:view_food' %}">View Food</a></li>
              </ul>
            </div>
          </li>

          <li class="nav-item menu-items">
            <a class="nav-link" href="{% url 'admin_app:view_orders' %}"><span class="menu-icon"><i class="mdi mdi-cart"></i></span><span class="menu-title">Orders</span></a>
          </li>

          <li class="nav-item menu-items">
            <a class="nav-link" href="{% url 'admin_app:order_reports' %}">
              <span class="menu-icon"><i class="mdi mdi-file-chart"></i></span>
              <span class="menu-title">Reports</span>
            </a>
          </li>

          <li class="nav-item menu-items">
            <a class="nav-link" href="{% url 'admin_app:view_customers' %}"><span class="menu-icon"><i class="mdi mdi-account-multiple"></i></span><span class="menu-title">Customers</span></a>
          </li>

          <li class="nav-item menu-items">
            <a class="nav-link" href="{% url 'admin_app:view_waiters' %}"><span class="menu-icon"><i class="mdi mdi-account-star"></i></span><span class="menu-title">Waiters</span></a>
          </li>

          <li class="nav-item menu-items">
            <a class="nav-link" href="{% url 'admin_app:delete_logout' %}"><span class="menu-icon"><i class="mdi mdi-logout"></i></span><span class="menu-title">Logout</span></a>
          </li>
        </ul>
      </nav>

      <!-- Navbar + Content -->
      <div class="container-fluid page-body-wrapper">

        <!-- Navbar -->
        <nav class="navbar p-0 fixed-top d-flex flex-row">
          <div class="navbar-brand-wrapper d-flex d-lg-none align-items-center justify-content-center">
            <a class="navbar-brand brand-logo-mini" href="#"><img src="{% static 'admin/assets/images/logo-mini.svg' %}" alt="logo" /></a>
          </div>
          <div class="navbar-menu-wrapper flex-grow d-flex align-items-stretch">
            <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
              <span class="mdi mdi-menu"></span>
            </button>
            <ul class="navbar-nav w-100">
              <li class="nav-item w-100">
                <form class="nav-link mt-2 mt-md-0 d-none d-lg-flex search">
                  <input type="text" class="form-control" placeholder="Search here">
                </form>
              </li>
            </ul>
          </div>
        </nav>

        <!-- Main Content -->
        <div class="main-panel">
          <div class="content-wrapper">
            <!-- Global Messages (SweetAlert) -->
            <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
            {% if messages %}
              {% for i in messages %}
                {% if i.tags == 'error' %}
                  <script>swal('{{ i|escapejs }}','', 'error');</script>
                {% elif i.tags == 'warning' %}
                  <script>swal('{{ i|escapejs }}','', 'warning');</script>
                {% endif %}
              {% endfor %}
            {% endif %}

            {% block content %}
            <div class="row">
              <div class="col-12 grid-margin stretch-card">
                <div class="card corona-gradient-card">
                  <div class="card-body text-center">
                    <h3 class="text-white mb-0">Welcome to <b>Restaurant Management Dashboard</b></h3>
                    <p class="text-white-50 mb-0">Manage food items, categories, and customers efficiently</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Stats Widgets -->
            <div class="row">
              <div class="col-md-3 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body d-flex align-items-center">
                    <div class="mr-3"><i class="mdi mdi-silverware text-primary" style="font-size:32px;"></i></div>
                    <div>
                      <h4 class="mb-1">Food Items</h4>
                      <h2 class="mb-0">{{ food_count }}</h2>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-3 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body d-flex align-items-center">
                    <div class="mr-3"><i class="mdi mdi-format-list-bulleted text-success" style="font-size:32px;"></i></div>
                    <div>
                      <h4 class="mb-1">Categories</h4>
                      <h2 class="mb-0">{{ category_count }}</h2>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-3 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body d-flex align-items-center">
                    <div class="mr-3"><i class="mdi mdi-account-multiple text-info" style="font-size:32px;"></i></div>
                    <div>
                      <h4 class="mb-1">Customers</h4>
                      <h2 class="mb-0">{{ customer_count }}</h2>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-3 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body d-flex align-items-center">
                    <div class="mr-3"><i class="mdi mdi-cart text-warning" style="font-size:32px;"></i></div>
                    <div>
                      <h4 class="mb-1">Orders</h4>
                      <h2 class="mb-0">{{ order_count }}</h2>
                      <small class="text-muted">{{ pending_order_count }} pending</small>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Recent Activity -->
            <div class="row">
              <div class="col-md-4 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Recent Food Items</h4>
                    <div class="table-responsive">
                      <table class="table table-hover">
                        <thead>
                          <tr>
                            <th>Name</th>
                            <th>Category</th>
                            <th>Price</th>
                            <th>Status</th>
                          </tr>
                        </thead>
                        <tbody>
                          {% for f in recent_foods %}
                          <tr>
                            <td>{{ f.name }}</td>
                            <td>{{ f.category.Category_name }}</td>
                            <td>₹{{ f.price }}</td>
                            <td>
                              {% if f.availability %}
                                <span class="badge badge-success">Available</span>
                              {% else %}
                                <span class="badge badge-secondary">Unavailable</span>
                              {% endif %}
                            </td>
                          </tr>
                          {% empty %}
                          <tr><td colspan="4" class="text-muted text-center">No items yet.</td></tr>
                          {% endfor %}
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Recent Orders</h4>
                    <ul class="list-group list-group-flush">
                      {% for order in recent_orders %}
                      <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                          <span><i class="mdi mdi-cart text-warning mr-2"></i>{{ order.order_id }}</span><br>
                          <small class="text-muted">{{ order.customer.Username }}</small>
                        </div>
                        <div class="text-right">
                          <span class="badge badge-{% if order.status == 'pending' %}warning{% elif order.status == 'completed' %}success{% else %}info{% endif %}">
                            {{ order.get_status_display }}
                          </span><br>
                          <small class="text-muted">₹{{ order.total_amount }}</small>
                        </div>
                      </li>
                      {% empty %}
                      <li class="list-group-item text-muted">No orders yet.</li>
                      {% endfor %}
                    </ul>
                    <div class="text-center mt-3">
                      <a href="{% url 'admin_app:view_orders' %}" class="btn btn-sm btn-outline-primary">View All Orders</a>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">New Customers</h4>
                    <ul class="list-group list-group-flush">
                      {% for c in recent_customers %}
                      <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span><i class="mdi mdi-account-circle text-info mr-2"></i>{{ c.Username }}</span>
                        <span class="text-muted small">{{ c.Email }}</span>
                      </li>
                      {% empty %}
                      <li class="list-group-item text-muted">No customers yet.</li>
                      {% endfor %}
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            {% endblock %}
          </div>

          <!-- Footer -->
          <footer class="footer">
            <div class="d-sm-flex justify-content-center justify-content-sm-between">
              <span class="text-muted text-center d-block d-sm-inline-block">© 2025 FlavourFiesta Restaurant Dashboard</span>
              <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center">Designed with ❤️ by Shelb!n</span>
            </div>
          </footer>
        </div>
      </div>
    </div>

    <!-- JS Assets -->
    <script src="{% static 'admin/assets/vendors/js/vendor.bundle.base.js' %}"></script>
    <script src="{% static 'admin/assets/vendors/chart.js/Chart.min.js' %}"></script>
    <script src="{% static 'admin/assets/vendors/progressbar.js/progressbar.min.js' %}"></script>
    <script src="{% static 'admin/assets/vendors/jvectormap/jquery-jvectormap.min.js' %}"></script>
    <script src="{% static 'admin/assets/vendors/jvectormap/jquery-jvectormap-world-mill-en.js' %}"></script>
    <script src="{% static 'admin/assets/vendors/owl-carousel-2/owl.carousel.min.js' %}"></script>
    <script src="{% static 'admin/assets/js/off-canvas.js' %}"></script>
    <script src="{% static 'admin/assets/js/hoverable-collapse.js' %}"></script>
    <script src="{% static 'admin/assets/js/misc.js' %}"></script>
    <script src="{% static 'admin/assets/js/settings.js' %}"></script>
    <script src="{% static 'admin/assets/js/todolist.js' %}"></script>
    <script src="{% static 'admin/assets/js/dashboard.js' %}"></script>
  </body>
</html>
